<script>
document.addEventListener("DOMContentLoaded", () => {
  const video = document.getElementById("camera");
  const captureBtn = document.getElementById("captureBtn");
  const canvas = document.getElementById("canvas");
  const photo = document.getElementById("photo");

  // ã‚«ãƒ¡ãƒ©èµ·å‹•
  navigator.mediaDevices.getUserMedia({ video: true })
    .then(stream => {
      video.srcObject = stream;
    })
    .catch(err => {
      alert("ã‚«ãƒ¡ãƒ©ã«ã‚¢ã‚¯ã‚»ã‚¹ã§ãã¾ã›ã‚“: " + err);
    });

  // å†™çœŸæ’®å½±
  captureBtn.addEventListener("click", () => {
    console.log("ğŸ“¸ ãƒœã‚¿ãƒ³æŠ¼ã•ã‚Œã¾ã—ãŸ");

    const context = canvas.getContext("2d");
    const width = video.videoWidth || 640;
    const height = video.videoHeight || 480;

    canvas.width = width;
    canvas.height = height;

    context.drawImage(video, 0, 0, width, height);

    const dataUrl = canvas.toDataURL("image/png");
    photo.src = dataUrl;

    console.log("âœ… å†™çœŸã‚’ç”Ÿæˆã—ã¾ã—ãŸ:", dataUrl.substring(0,50));
  });
});
</script>
